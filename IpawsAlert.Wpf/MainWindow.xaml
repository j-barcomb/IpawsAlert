<Window x:Class="IpawsAlert.Wpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:IpawsAlert.Wpf.ViewModels"
        xmlns:views="clr-namespace:IpawsAlert.Wpf.Views"
        xmlns:conv="clr-namespace:IpawsAlert.Wpf.Converters"
        Title="IPAWS Alert Console"
        Width="1180" Height="780"
        MinWidth="900" MinHeight="600"
        Background="{StaticResource Brush.Bg.Shell}"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <conv:BoolToVisConverter        x:Key="BoolToVis"/>
        <conv:InverseBoolToVisConverter x:Key="InvBoolToVis"/>
        <conv:SuccessToBrushConverter   x:Key="SuccessBrush"/>

        <DataTemplate DataType="{x:Type vm:ComposeViewModel}">
            <views:ComposeView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:HistoryViewModel}">
            <views:HistoryView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:SettingsViewModel}">
            <views:SettingsView/>
        </DataTemplate>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- SIDEBAR -->
        <Border Grid.Column="0"
                Background="{StaticResource Brush.Bg.Sidebar}"
                BorderBrush="{StaticResource Brush.Border.Default}"
                BorderThickness="0,0,1,0">
            <DockPanel>

                <!-- Branding -->
                <Border DockPanel.Dock="Top" Padding="20,22,20,18"
                        BorderBrush="{StaticResource Brush.Border.Default}"
                        BorderThickness="0,0,0,1">
                    <StackPanel>
                        <TextBlock Text="IPAWS"
                                   FontSize="20" FontWeight="Bold"
                                   Foreground="{StaticResource Brush.Text.Primary}"/>
                        <TextBlock Text="ALERT CONSOLE"
                                   FontSize="9" FontWeight="SemiBold"
                                   Foreground="{StaticResource Brush.Accent.Blue}"
                                   Margin="0,2,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Bottom status strip -->
                <Border DockPanel.Dock="Bottom" Padding="16,12"
                        BorderBrush="{StaticResource Brush.Border.Default}"
                        BorderThickness="0,1,0,0">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <Ellipse Width="7" Height="7" Margin="0,0,7,0" VerticalAlignment="Center">
                                <Ellipse.Fill>
                                    <Binding Path="IsConnected" Converter="{StaticResource SuccessBrush}"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Text="{Binding ConnectionLabel}"
                                       FontSize="10" FontWeight="SemiBold"
                                       Foreground="{StaticResource Brush.Text.Secondary}"/>
                        </StackPanel>
                        <TextBlock Text="{Binding Settings.ActiveEndpointLabel}"
                                   FontSize="9" Foreground="{StaticResource Brush.Text.Muted}"
                                   TextWrapping="Wrap"/>
                        <TextBlock Text="{Binding StatusText}"
                                   FontSize="10" Foreground="{StaticResource Brush.Text.Secondary}"
                                   TextWrapping="Wrap" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Nav -->
                <StackPanel DockPanel.Dock="Top" Margin="8,12,8,0">
                    <TextBlock Text="NAVIGATION"
                               FontSize="9" FontWeight="SemiBold"
                               Foreground="{StaticResource Brush.Text.Muted}"
                               Margin="16,0,0,8"/>

                    <RadioButton Style="{StaticResource Style.NavButton}"
                                 IsChecked="{Binding IsComposePage, Mode=OneWay}"
                                 Command="{Binding GoToComposeCommand}">
                        <TextBlock Text="⊕  Compose Alert" FontSize="13"/>
                    </RadioButton>

                    <RadioButton Style="{StaticResource Style.NavButton}"
                                 IsChecked="{Binding IsHistoryPage, Mode=OneWay}"
                                 Command="{Binding GoToHistoryCommand}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="≡  Submission History" FontSize="13"/>
                            <Border Background="{StaticResource Brush.Accent.Blue}"
                                    CornerRadius="8" Padding="5,1" Margin="6,0,0,0"
                                    VerticalAlignment="Center">
                                <TextBlock Text="{Binding History.Entries.Count}"
                                           FontSize="10" Foreground="White" FontWeight="Bold"/>
                            </Border>
                        </StackPanel>
                    </RadioButton>

                    <RadioButton Style="{StaticResource Style.NavButton}"
                                 IsChecked="{Binding IsSettingsPage, Mode=OneWay}"
                                 Command="{Binding GoToSettingsCommand}">
                        <TextBlock Text="⚙  Settings" FontSize="13"/>
                    </RadioButton>
                </StackPanel>

            </DockPanel>
        </Border>

        <!-- MAIN CONTENT -->
        <ContentPresenter Grid.Column="1" Content="{Binding CurrentViewModel}"/>
    </Grid>
</Window>
